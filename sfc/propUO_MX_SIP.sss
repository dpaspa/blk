****************************************************************************************************
SEQUENCE STEP SCHEDULE
generated on 1/05/2018 6:28:51 PM by David Paspa
****************************************************************************************************





--------------------------------------------------
SEQUENCE
--------------------------------------------------

SFCNo:- 0
Title:- UO_MX_SIP
Description:- Sequence for Mx sterilise in place operation
Name:- SIP
Class:- MX
Level:- UO
STEP_LIST_FORMAT:- JU    S0@@STEP_NUM@@; // STEP-0@@STEP_NUM@@:
ACT_LIST_FORMAT:- JU    @@ACT_CODE@@@@STEP_NUM@@; //ACTION-@@ACT_NUM@@
HeaderName:- MUSIP
Version:- 0.3
RevisionHistory:- // SFC Revision History:
// Rev By               Date        CC         Note
// 0.3 Srinivas Nimmala  19-May-2010  Wong(Changed Cooling-Preempt)
// 0.2 David Paspa      26-Oct-2009            Added synch flags
// 0.1 Gerald Kontriner 09-Sep-2009            SFC structural design
HMI_FORMAT:- @@STEP_NUM_INT@@,@@STEP_TITLE@@

--------------------------------------------------
PARAMETER::1
--------------------------------------------------
Name:- ABORT_TIMER
Type:- TON
Description:- Timer for TIME_SIP_ABORT
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::2
--------------------------------------------------
Name:- log_real_emg_ti_vent_pv
Type:- BOOL
Description:- Description
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::3
--------------------------------------------------
Name:- log_real_emg_ti_drain_pv
Type:- BOOL
Description:- Description
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::4
--------------------------------------------------
Name:- log_real_emv_ti_vessel_pv
Type:- BOOL
Description:- Description
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::5
--------------------------------------------------
Name:- log_real_emx_ti_drain_pv
Type:- BOOL
Description:- Description
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::6
--------------------------------------------------
Name:- real_emg_ti_vent_pv
Type:- REAL
Description:- Description
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::7
--------------------------------------------------
Name:- real_emg_ti_drain_pv
Type:- REAL
Description:- Description
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::8
--------------------------------------------------
Name:- real_emv_ti_vessel_pv
Type:- REAL
Description:- Description
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::9
--------------------------------------------------
Name:- real_emx_ti_drain_pv
Type:- REAL
Description:- Description
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::10
--------------------------------------------------
Name:- TEMP_TIMER
Type:- TON
Description:- Temperature Timer for interval logging
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::11
--------------------------------------------------
Name:- log_msg_pres_blow_reached
Type:- BOOL
Description:- Flags the HMI to log time when HPCA BLOW pressure reached
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::12
--------------------------------------------------
Name:- log_msg_pres_leave_reached
Type:- BOOL
Description:- Flags the HMI to log time when HPCA LEAVE pressure reached
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::13
--------------------------------------------------
Name:- log_msg_sip_timer_reset
Type:- Type
Description:- Flags the HMI to log SIP timer reset

--------------------------------------------------
PARAMETER::14
--------------------------------------------------
Name:- log_time_sip_start
Type:- BOOL
Description:- Flags the HMI that SIP started
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::15
--------------------------------------------------
Name:- time_sip_start
Type:- TOD
Description:- SIP start time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::16
--------------------------------------------------
Name:- log_msg_sip_abort
Type:- BOOL
Description:- Flags the HMI to log automatic SIP abort
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::17
--------------------------------------------------
Name:- log_msg_vacuum_fail_abort
Type:- BOOL
Description:- HMI msg:Operator abort to try again when vacuum ejector time failed
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::18
--------------------------------------------------
Name:- log_msg_vacuum_fail_repeat
Type:- BOOL
Description:- HMI msg:Operator confirms to try again when vacuum ejector time failed
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::19
--------------------------------------------------
Name:- time_vacuum_fail
Type:- TOD
Description:- Logging vacuum ejector failed time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::20
--------------------------------------------------
Name:- log_time_vacuum_fail
Type:- BOOL
Description:- Flags the HMI that vacuum ejector failed detected
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::21
--------------------------------------------------
Name:- log_msg_vacuum_fail
Type:- BOOL
Description:- Flag raising vacuum failed message
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::22
--------------------------------------------------
Name:- log_time_steam_closed
Type:- BOOL
Description:- Flags the HMI to log Steam Closed Time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::23
--------------------------------------------------
Name:- log_real_positive_pressure
Type:- BOOL
Description:- Flag positive pressure
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::24
--------------------------------------------------
Name:- log_time_steam_open
Type:- BOOL
Description:- Flags the HMI to log Steam Opened Time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::25
--------------------------------------------------
Name:- time_vacuum_begin
Type:- TOD
Description:- Vacuum begin time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::26
--------------------------------------------------
Name:- log_time_vacuum_begin
Type:- BOOL
Description:- Flags the HMI to log Vacuum begin time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::27
--------------------------------------------------
Name:- log_time_sip_begin
Type:- BOOL
Description:- Flags the HMI that Mx SIP started
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::28
--------------------------------------------------
Name:- time_sip_begin
Type:- TOD
Description:- Logging Mx SIP operation start time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::29
--------------------------------------------------
Name:- log_time_sip_end
Type:- BOOL
Description:- Flags the HMI that Mx SIP ended
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::30
--------------------------------------------------
Name:- time_sip_end
Type:- TOD
Description:- Logging Mx SIP operation end time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::31
--------------------------------------------------
Name:- log_time_sip_complete
Type:- BOOL
Description:- Flags the HMI that SIP completed
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::32
--------------------------------------------------
Name:- time_sip_complete
Type:- TOD
Description:- SIP completion time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::33
--------------------------------------------------
Name:- release_mx
Type:- BOOL
Description:- Release Mx
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::34
--------------------------------------------------
Name:- pi_vessel
Type:- REAL
Description:- Vessel pressure
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::35
--------------------------------------------------
Name:- pulse_number
Type:- INT
Description:- Number of valve pulsing times
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::36
--------------------------------------------------
Name:- pulse_counter
Type:- INT
Description:- counter pulse_vlv
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::37
--------------------------------------------------
Name:- num_sip_abort
Type:- INT
Description:- number of SIP abort times
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::38
--------------------------------------------------
Name:- ctr_sip_abort
Type:- INT
Description:- counter of SIP abort times
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::39
--------------------------------------------------
Name:- time_sip
Type:- TIME
Description:- Description
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::40
--------------------------------------------------
Name:- sip_timer_started
Type:- BOOL
Description:- sip_timer_started
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::41
--------------------------------------------------
Name:- time_sip_abort
Type:- TIME
Description:- time_sip_abort
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::42
--------------------------------------------------
Name:- time_stm_drain_mx
Type:- TIME
Description:- time_stm_drain_mx
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::43
--------------------------------------------------
Name:- emx_drain_cmd
Type:- INT
Description:- Command to emx_drain
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::44
--------------------------------------------------
Name:- emx_drain_subs
Type:- INT
Description:- Substate selection to emx_drain
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::45
--------------------------------------------------
Name:- emx_drain_state
Type:- INT
Description:- Device state of emx_drain
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::46
--------------------------------------------------
Name:- time_eject
Type:- TIME
Description:- Vacuum eject time
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::47
--------------------------------------------------
Name:- pres_vac
Type:- REAL
Description:- vacuum pressure
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::48
--------------------------------------------------
Name:- ema_vessel_cmd
Type:- INT
Description:- Command to ema_vessel
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::49
--------------------------------------------------
Name:- ema_vessel_subs
Type:- INT
Description:- Substate selection to ema_vessel
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::50
--------------------------------------------------
Name:- ema_vessel_state
Type:- INT
Description:- Device State of ema_vessel
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::51
--------------------------------------------------
Name:- emx_mmfl_cmd
Type:- INT
Description:- Command to emx_mmfl
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::52
--------------------------------------------------
Name:- emx_mmfl_subs
Type:- INT
Description:- Substate selection to emx_mmfl
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::53
--------------------------------------------------
Name:- emx_mmfl_state
Type:- INT
Description:- Device state of emx_mmfl
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::54
--------------------------------------------------
Name:- temp_sip
Type:- REAL
Description:- SIP temperature
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::55
--------------------------------------------------
Name:- temp_sip_vent
Type:- REAL
Description:- VENT valve SIP temperature
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::56
--------------------------------------------------
Name:- emv_ti_vessel_pv
Type:- REAL
Description:- TIn105 Vessel Temperature
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::57
--------------------------------------------------
Name:- emg_ti_drain_pv
Type:- REAL
Description:- TIn103 Vent Filter Top Outlet Temperature
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::58
--------------------------------------------------
Name:- emg_ti_vent_pv
Type:- REAL
Description:- TIn101 Vent Filter Temperature
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::59
--------------------------------------------------
Name:- emx_ti_drain_pv
Type:- REAL
Description:- TIn107 Drain Temperature
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::60
--------------------------------------------------
Name:- log_disconnect
Type:- BOOL
Description:- Logging operator confirmed all vessel utility at pipe entry are disconnected.
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::61
--------------------------------------------------
Name:- time_steam_closed
Type:- TOD
Description:- Logging closed system start time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::62
--------------------------------------------------
Name:- real_positive_pressure
Type:- REAL
Description:- Logging positive pressure measurment.
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::63
--------------------------------------------------
Name:- time_steam_open
Type:- TOD
Description:- Logging Steam Opened Time
ParameterInOut:- VAR

--------------------------------------------------
PARAMETER::64
--------------------------------------------------
Name:- emc_water_cmd
Type:- INT
Description:- Command to emc_water
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::65
--------------------------------------------------
Name:- emc_water_subs
Type:- INT
Description:- Substate selection to emc_water
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::66
--------------------------------------------------
Name:- emc_water_medium
Type:- INT
Description:- Medium selection to emc_water
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::67
--------------------------------------------------
Name:- emc_gas_setpoint
Type:- REAL
Description:- emc_gas pressure setpoint
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::68
--------------------------------------------------
Name:- emg_filter_state
Type:- INT
Description:- Device State of emg_filter
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::69
--------------------------------------------------
Name:- emc_water_state
Type:- INT
Description:- Device State of emc_water
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::70
--------------------------------------------------
Name:- emg_filter_subs
Type:- INT
Description:- Substate selection to emg_filter
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::71
--------------------------------------------------
Name:- emg_filter_cmd
Type:- INT
Description:- Command to emg_filter
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::72
--------------------------------------------------
Name:- emc_gas_medium
Type:- INT
Description:- emc_gas_medium
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::73
--------------------------------------------------
Name:- emc_gas_subs
Type:- INT
Description:- Substate selection to emc_gas
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::74
--------------------------------------------------
Name:- emv_vessel_subs
Type:- INT
Description:- Substate selection to emv_vessel
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::75
--------------------------------------------------
Name:- emv_vessel_cmd
Type:- INT
Description:- Command to emv_vessel
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::76
--------------------------------------------------
Name:- emc_gas_state
Type:- INT
Description:- Device State of emc_gas
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::77
--------------------------------------------------
Name:- emc_gas_cmd
Type:- INT
Description:- Command to emc_gas
ParameterInOut:- OUT

--------------------------------------------------
PARAMETER::78
--------------------------------------------------
Name:- time_drain_pulse
Type:- TIME
Description:- Time for drain pulsing.
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::79
--------------------------------------------------
Name:- pres_hpca_leave
Type:- REAL
Description:- HPCA pressure to leave 
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::80
--------------------------------------------------
Name:- pres_hpca_blow
Type:- REAL
Description:- Pressure
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::81
--------------------------------------------------
Name:- pres_lpca_blank
Type:- REAL
Description:- LPCA blanket pressure
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::82
--------------------------------------------------
Name:- pres_stm_pos
Type:- REAL
Description:- Positive steam pressure threshold
ParameterInOut:- IN

--------------------------------------------------
PARAMETER::83
--------------------------------------------------
Name:- emv_vessel_state
Type:- INT
Description:- Device state of emv_vessel
ParameterInOut:- IN


--------------------------------------------------
STEP::01
--------------------------------------------------
StepNo:- 01
Title:- UO_MX_SIP : Unit operation started
Description:- Log SIP operation begin time.
Open valves on Mx to Drain flow path.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log SIP operation begin time.
Open Mx outlet valve.
Start emx_mmfl SIP.
Action:- //Log SIP operation begin time.
L "dbCONST".CHRONO.CPU_TIME;
T #_time_sip_begin;

SET;
S #_log_time_sip_begin;

//Open Mx outlet valve.
L "dbCONST".BLK.EMV1.SUBS.DISCHARGE;
T #_emv_vessel_subs;
L "dbCONST".BLK.CMD.START;
T #_emv_vessel_cmd;

//Start emx_mmfl SIP.
L "dbCONST".BLK.EMX1.SUBS.SIP;
T #_emx_mmfl_subs;
L "dbCONST".BLK.CMD.START;
T #_emx_mmfl_cmd;

// Reset used flags
SET;
R #_release_mx;

Verification:- A(;
L #_emv_vessel_state;
L "dbCONST".BLK.EMV1.SUBS.DISCHARGE;
==I;
);


--------------------------------------------------
STEP::02
--------------------------------------------------
StepNo:- 02
Title:- UO_MX_SIP : Vacuum Operation Commenced
Description:- Set other Mx equipments to SAFE state.

Enable vacuum and start vacuum timer(time_eject). Log vacuum start time

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Set other Mx equipment to SAFE state.
Action:- L "dbCONST".BLK.SAFE.CMD;
T  #_ema_vessel_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_ema_vessel_cmd;

L "dbCONST".BLK.SAFE.CMD;
T  #_emc_gas_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emc_gas_cmd;

L "dbCONST".BLK.SAFE.CMD;
T  #_emc_water_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emc_water_cmd;
Verification:- A(;
L #_ema_vessel_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);
A(;
L #_emc_gas_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);
A(;
L #_emc_water_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);

--------------------------------------------------
ACTION::02
--------------------------------------------------
Description:- Enable vacuum and start vacuum timer. Log Vacuum begin time
Action:- //Enable vacuum.
L "dbCONST".SEL.GAS.VACUUM;
T #_emc_gas_medium;
L "dbCONST".BLK.EMC1.SUBS.VALVE;
T #_emc_gas_subs;
L "dbCONST".BLK.CMD.START;
T #_emc_gas_cmd;

// Start vacuum timer
A #SQ_TIMER.Q;
R #SQ_TIMER.IN;

AN #SQ_TIMER.Q;
S #SQ_TIMER.IN;
L #_time_eject;
T #SQ_TIMER.PT;

//Log vacuum begin time.
L "dbCONST".CHRONO.CPU_TIME;
T #_time_vacuum_begin;

SET;
S #_log_time_vacuum_begin

//Report Event 
SET;
S #_Report_Evnt_017;
R #_Report_Evnt_018;
Verification:- A #SQ_TIMER.IN;


--------------------------------------------------
TRANSITION::02
--------------------------------------------------
TRNNo:- 02
Title:- Pressure below setpoint?
EmptyTransition:- False
Description:- Pressure reduced below PRES_VAC.
Condition:- A(;
L #_pi_vessel;
L #_pres_vac;
<R;
);


--------------------------------------------------
TRANSITION::03
--------------------------------------------------
TRNNo:- 03
Title:- Timer expired?
EmptyTransition:- False
Description:- Vacuum timer expired.
Condition:- A #SQ_TIMER.Q;


--------------------------------------------------
STEP::03
--------------------------------------------------
StepNo:- 03
Title:- UO_MX_SIP : Evacuation failed
Description:- Raise vacuum failed message.
Log vacuum time failed.
Prompt operator to confirm to try again.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Raise vacuum failed message.
Log vacuum time failed.
Prompt operator to confirm to try again.
Action:- //Log time vacuum failed
L "dbCONST".CHRONO.CPU_TIME;
T #_time_vacuum_fail;

SET;
S #_log_time_vacuum_fail;
S #_log_msg_vacuum_fail;
S #_prompt_try_again;

//Report Event reset
SET;
R #_Report_Evnt_017;

//Report Event Set
SET;
S #_Report_Evnt_018;
Verification:- A M1.1; //Always High flag


--------------------------------------------------
TRANSITION::04
--------------------------------------------------
TRNNo:- 04
Title:- Try again?
EmptyTransition:- False
Description:- Operator want to try again.
Condition:- A #_confirm_try_again;


--------------------------------------------------
TRANSITION::05
--------------------------------------------------
TRNNo:- 05
Title:- No try?
EmptyTransition:- False
Description:- Operator don't want to try again.
Condition:- A #_confirm_no_try;


--------------------------------------------------
STEP::04
--------------------------------------------------
StepNo:- 4.0000
Title:- UO_MX_SIP : Vacuum operation finished.
Description:- Close Mx vacuum valves.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Close Mx Vacuum Valve.
Action:- //Disable vacuum.
L "dbCONST".BLK.SAFE.CMD;
T  #_emc_gas_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emc_gas_cmd;

// Stop timer
SET;
R #SQ_TIMER.IN;

//Report Event Set
SET;
S #_Report_Evnt_018;
Verification:- A M1.1; //Always High flag


--------------------------------------------------
TRANSITION::06
--------------------------------------------------
TRNNo:- 6.0000
Title:- All Vacuum operations complete
EmptyTransition:- False
Description:- Vacuum valve closed.
Condition:- A(;
L 	#_emc_gas_state;
L 	"dbCONST".BLK.STATE.STOPPED;
==I;
);


--------------------------------------------------
STEP::05
--------------------------------------------------
StepNo:- 5.0000
Title:- UO_MX_SIP : Log Operator Repeat
Description:- Log operator repeat.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log operator repeat.
Action:- //Log operator repeat.
SET;
S #_log_msg_vacuum_fail_repeat;
Verification:- A M1.1; //Always High flag


--------------------------------------------------
STEP::06
--------------------------------------------------
StepNo:- 6.0000
Title:- UO_MX_SIP : Log Operator Abort
Description:- Log operator abort.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log operator abort.
Action:- //Log operator abort.
SET;
S #_log_msg_vacuum_fail_abort;
Verification:- A M1.1; //Always High flag


--------------------------------------------------
TRANSITION::07
--------------------------------------------------
TRNNo:- 7.0000
Title:- Empty Transition
EmptyTransition:- False
Description:- Empty Transition
Condition:- A M1.1; //Always High flag


--------------------------------------------------
STEP::07
--------------------------------------------------
StepNo:- 07
Title:- UO_MX_SIP : Initiate MX and MMFLx SIP Operations
Description:- Open Mx steam supply on WFI/PS lines.

Log steam opened time.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Open Mx steam supply on WFI/PS lines.

Log steam opened time.
Action:- //Set emc_water to substate FLUSH and open WFI/PS supply valve.
L "dbCONST".SEL.LIQUID.PSWFI;
T #_emc_water_medium;
L "dbCONST".BLK.EMC2.SUBS.FLUSH;
T #_emc_water_subs;
L "dbCONST".BLK.CMD.START;
T #_emc_water_cmd;


//Log steam opened time.
L "dbCONST".CHRONO.CPU_TIME;
T #_time_steam_open;

SET;
S #_log_time_steam_open;
Verification:- //Verify if emc_water changed to substate FLUSH.
A(;
L   #_emc_water_state;
L   "dbCONST".BLK.EMC2.SUBS.FLUSH;
==I;
);


--------------------------------------------------
TRANSITION::08
--------------------------------------------------
TRNNo:- 08
Title:- Pressure check
EmptyTransition:- False
Description:- Pressure increased above PRES_STM_POS. PCx013> PRES_STM_POS
Condition:- A(;
L 	#_pi_vessel;
L 	#_pres_stm_pos;
>R;
);


--------------------------------------------------
STEP::08
--------------------------------------------------
StepNo:- 08
Title:- UO_MX_SIP : Positive pressure. 
Description:- Positive pressure has been achieved.
Log actual positive pressure.

Open Mx SIP condensate drain valve and vent filter drain valve.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log actual positive pressure.
Open Mx SIP condensate drain valve and vent filter drain valve.
Action:- //Log actual positive pressure.
L #_pi_vessel;
T #_real_positive_pressure;

SET;
S #_log_real_positive_pressure;

//Start EMX4_SIP.
L "dbCONST".BLK.EMX4.SUBS.SIP;
T #_emx_drain_subs;
L "dbCONST".BLK.CMD.START;
T #_emx_drain_cmd;

// Set vessel VENT filter EM to substate SIP
L "dbCONST".BLK.EMG1.SUBS.SIP;
T #_emg_filter_subs;
L "dbCONST".BLK.CMD.START;
T #_emg_filter_cmd;
Verification:- A(;
L #_emx_drain_state;
L "dbCONST".BLK.EMX4.SUBS.SIP;
==I;
);
A(;
L #_emg_filter_state;
L "dbCONST".BLK.EMG1.SUBS.SIP;
==I;
);


--------------------------------------------------
TRANSITION::09
--------------------------------------------------
TRNNo:- 09
Title:- Empty Transition
EmptyTransition:- False
Description:- Empty Transition
Condition:- A M1.1; //Always High flag


--------------------------------------------------
STEP::09
--------------------------------------------------
StepNo:- 09
Title:- UO_MX_SIP : Wait for free steaming timer
Description:- Start timer TIME_STM_DRAIN_Mx

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Start timer TIME_STM_DRAIN_Mx
Action:- //Start Timer for steaming
A #SQ_TIMER.Q;
R #SQ_TIMER.IN;

AN #SQ_TIMER.Q;
S #SQ_TIMER.IN;
L #_time_stm_drain_mx;
T #SQ_TIMER.PT;
Verification:- A #SQ_TIMER.IN;


--------------------------------------------------
TRANSITION::10
--------------------------------------------------
TRNNo:- 10
Title:- Timer expired
EmptyTransition:- False
Description:- Timer TIME_STM_DRAIN_Mx expired?
Condition:- A #SQ_TIMER.Q;


--------------------------------------------------
STEP::10
--------------------------------------------------
StepNo:- 10
Title:- UO_MX_SIP : Free steam complete. 
Description:- Log closed system steaming start time

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log closed system start time

Action:- //Log closed system start time.
L "dbCONST".CHRONO.CPU_TIME;
T #_time_steam_closed;

SET;
S #_log_time_steam_closed;
Verification:- A M1.1; //Always High flag


--------------------------------------------------
TRANSITION::11
--------------------------------------------------
TRNNo:- 11
Title:- Empty Transition
EmptyTransition:- False
Description:- Empty Transition
Condition:- A M1.1; //Always High flag


--------------------------------------------------
STEP::11
--------------------------------------------------
StepNo:- 11
Title:- UO_MX_SIP : Monitor MX SIP Temperatures
Description:- Log all Mx vessel temperatures every 30sec once SIP started first time.
Start TIME_SIP_ABORT timer.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Skip timer for SIP_ABORT if sip_timer_started=FALSE.
Set flags to log all Mx vessel temperatures  every 30sec. 
Reset flags.
Action:- //Skip timer for SIP_ABORT if sip_timer_started=FALSE.
A #_sip_timer_started;
JC tsi1;

// Start SIP ABORT timer
A #ABORT_TIMER.Q;
R #ABORT_TIMER.IN;

AN #ABORT_TIMER.Q;
S #ABORT_TIMER.IN;
L #_time_sip_abort;
T #ABORT_TIMER.PT;


tsi1: NOP 0;
//SIP started.
//Log all temperatures
A #TEMP_TIMER.Q;
JCN NEXT
SET;
R #TEMP_TIMER.IN;
L #_emg_ti_vent_pv;
T #_real_emg_ti_vent_pv;
L #_emg_ti_vent_pv;
T #_real_emg_ti_drain_pv;
L #_emg_ti_vent_pv;
T #_real_emv_ti_vessel_pv;
L #_emg_ti_vent_pv;
T #_real_emx_ti_drain_pv;

SET;
S #_log_real_emg_ti_vent_pv;
S #_log_real_emg_ti_drain_pv;
S #_log_real_emv_ti_vessel_pv;
S #_log_real_emx_ti_drain_pv;

NEXT: NOP 0;
AN #TEMP_TIMER.Q;
S #TEMP_TIMER.IN;
L T#30S;
T #TEMP_TIMER.PT;


//Report Event Set
SET;
S #_Report_Evnt_019;

//Report Event Reset
SET;
R #_Report_Evnt_020;
Verification:- A M1.1; //Always High flag


--------------------------------------------------
TRANSITION::12
--------------------------------------------------
TRNNo:- 12
Title:- Temperature below setpoint
EmptyTransition:- False
Description:- SIP timer running and any temperature below TEMP_SIP or the vent filter inlet temperature below TEMP_SIP_VENT?
Condition:- A #_sip_timer_started;
A(;
//TIn101
O(;
L 	#_emg_ti_vent_pv;
L 	#_temp_sip_vent;
<R;
);
//TIn103
O(;
L              #_emg_ti_drain_pv;
L 	#_temp_sip_vent;
<R;
);
//TIn105
O(;
L              #_emv_ti_vessel_pv;
L 	#_temp_sip;
<R;
);
//TIn107.
O(;
L              #_emx_ti_drain_pv;
L 	#_temp_sip;
<R;
);
);


--------------------------------------------------
TRANSITION::13
--------------------------------------------------
TRNNo:- 13
Title:- All temperatures above setpoint.
EmptyTransition:- False
Description:- All SIP temperatures above TEMP_SIP °C and the vent filter inlet temperature above TEMP_SIP_VENT?
and SIP timer not running? 
Mx Gas Filter TI_x101, Mx vent line TI_x103, Mx Vessel TI_x105, MFLx Filtration Line TI_x107 & Mx Drain TI_x109.
Condition:- AN #_sip_timer_started;
AN #SQ_TIMER.Q;

//TIn101
A(;
L 	#_emg_ti_vent_pv;
L 	#_temp_sip_vent;
>R;
);
//TIn103
A(;
L              #_emg_ti_drain_pv;
L 	#_temp_sip_vent;
>R;
);
//TIn105
A(;
L              #_emv_ti_vessel_pv;
L 	#_temp_sip;
>R;
);
//TIn107.
A(;
L              #_emx_ti_drain_pv;
L 	#_temp_sip;
>R;
);


--------------------------------------------------
TRANSITION::14
--------------------------------------------------
TRNNo:- 14
Title:- SIP Timer Expired
EmptyTransition:- False
Description:- Timer TIME_SIP expired.
Condition:- A #SQ_TIMER.Q;
A #_sip_timer_started;


--------------------------------------------------
TRANSITION::15
--------------------------------------------------
TRNNo:- 15
Title:- Abort timer expired
EmptyTransition:- False
Description:- Timer TIME_SIP_ABORT is expired.
Condition:- A #ABORT_TIMER.Q;
AN #_sip_timer_started;


--------------------------------------------------
STEP::12
--------------------------------------------------
StepNo:- 12
Title:- UO_MX_SIP : Start MX SIP timer 
Description:- Start SIP timer TIME_SIP.
Set sip_timer_started.
Log SIP start time.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Start SIP timer TIME_SIP.
Log SIP start time and Set sip_timer_started.
Action:- A #SQ_TIMER.Q;
R #SQ_TIMER.IN;

AN #SQ_TIMER.Q;
S #SQ_TIMER.IN;
L #_time_sip;
T #SQ_TIMER.PT;

//Log SIP start time.
L "dbCONST".CHRONO.CPU_TIME;
T #_time_sip_start;

//SIP timer started
SET;
S #_log_time_sip_start;
S #_sip_timer_started;


//Log all temperatures if 30 seconds passed.
A #TEMP_TIMER.Q;
JCN NEXT1
SET;
R #TEMP_TIMER.IN;
L #_emg_ti_vent_pv;
T #_real_emg_ti_vent_pv;
L #_emg_ti_vent_pv;
T #_real_emg_ti_drain_pv;
L #_emg_ti_vent_pv;
T #_real_emv_ti_vessel_pv;
L #_emg_ti_vent_pv;
T #_real_emx_ti_drain_pv;

SET;
S #_log_real_emg_ti_vent_pv;
S #_log_real_emg_ti_drain_pv;
S #_log_real_emv_ti_vessel_pv;
S #_log_real_emx_ti_drain_pv;

NEXT1: NOP 0;
AN #TEMP_TIMER.Q;
S #TEMP_TIMER.IN;
L T#30S;
T #TEMP_TIMER.PT;
Verification:- A #SQ_TIMER.IN;


--------------------------------------------------
TRANSITION::16
--------------------------------------------------
TRNNo:- 16
Title:- SIP Timer Expired
EmptyTransition:- False
Description:- Timer TIME_SIP not yet expired.
Condition:- AN #SQ_TIMER.Q;


--------------------------------------------------
STEP::13
--------------------------------------------------
StepNo:- 13
Title:- UO_MX_SIP : Low MX temperature during SIP
Description:- Reset sip_timer_started and log timer RESET.
Increase counter.

Log all temperatures if 30 seconds passed.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Reset sip_timer_started and log timer RESET.
Increase counter.
Action:- A #SQ_TIMER.Q;
R #SQ_TIMER.IN;

//Reset flag.
SET;
R #_sip_timer_started;
S #_log_msg_sip_timer_reset;

//Increase counter.
L #_ctr_sip_abort;
INC 1;
T #_ctr_sip_abort;

//Report Event Reset
SET;
R #_Report_Evnt_019;

//Report Event Set
SET;
S #_Report_Evnt_020;
Verification:- A M1.1; //Always High flag

--------------------------------------------------
ACTION::02
--------------------------------------------------
Description:- Log all temperatures if 30 seconds passed.
Action:- //Log all temperatures if 30 seconds passed.
A #TEMP_TIMER.Q;
JCN NEXT2
SET;
R #TEMP_TIMER.IN;
L #_emg_ti_vent_pv;
T #_real_emg_ti_vent_pv;
L #_emg_ti_vent_pv;
T #_real_emg_ti_drain_pv;
L #_emg_ti_vent_pv;
T #_real_emv_ti_vessel_pv;
L #_emg_ti_vent_pv;
T #_real_emx_ti_drain_pv;

SET;
S #_log_real_emg_ti_vent_pv;
S #_log_real_emg_ti_drain_pv;
S #_log_real_emv_ti_vessel_pv;
S #_log_real_emx_ti_drain_pv;

NEXT2: NOP 0;
AN #TEMP_TIMER.Q;
S #TEMP_TIMER.IN;
L T#30S;
T #TEMP_TIMER.PT;
Verification:- A M1.1;


--------------------------------------------------
TRANSITION::17
--------------------------------------------------
TRNNo:- 17
Title:- Retry SIP again
EmptyTransition:- False
Description:- Temperature has dropped less than 'NUM_SIP_ABORT' times
Condition:- A(;
L 	#_ctr_sip_abort;
L 	#_num_sip_abort;
<I;
);


--------------------------------------------------
TRANSITION::18
--------------------------------------------------
TRNNo:- 18
Title:- Abort SIP
EmptyTransition:- False
Description:- Temperature has dropped 'NUM_SIP_ABORT' times.
Condition:- //ABORT timer expired.
O #ABORT_TIMER.Q;
//Temperature has dropped NUM_SIP_ABORT times.
O(;
L 	#_ctr_sip_abort;
L 	#_num_sip_abort;
>=I;
);




--------------------------------------------------
STEP::14
--------------------------------------------------
StepNo:- 14
Title:- UO_MX_SIP : MX complete
Description:- Log SIP completion time.
Clear pulse_counter.
Close Mx steam supply on WFI/PS.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log SIP completion time.
Clear counter CTR_PULSE_VLV.
Close Mx steam supply on WFI/PS.
Action:- //Log SIP completion time
L "dbCONST".CHRONO.CPU_TIME;
T #_time_sip_complete;

SET;
S #_log_time_sip_complete;

//Clear counter
L 0;
T #_pulse_counter; 

L "dbCONST".BLK.SAFE.CMD;
T  #_emc_water_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emc_water_cmd;

//Log all temperatures if 30 seconds passed.
A #TEMP_TIMER.Q;
JCN NEXT3
SET;
R #TEMP_TIMER.IN;
L #_emg_ti_vent_pv;
T #_real_emg_ti_vent_pv;
L #_emg_ti_vent_pv;
T #_real_emg_ti_drain_pv;
L #_emg_ti_vent_pv;
T #_real_emv_ti_vessel_pv;
L #_emg_ti_vent_pv;
T #_real_emx_ti_drain_pv;

SET;
S #_log_real_emg_ti_vent_pv;
S #_log_real_emg_ti_drain_pv;
S #_log_real_emv_ti_vessel_pv;
S #_log_real_emx_ti_drain_pv;

NEXT3: NOP 0;
AN #TEMP_TIMER.Q;
S #TEMP_TIMER.IN;
L T#30S;
T #TEMP_TIMER.PT;
Verification:- A(;
L #_emc_water_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);


--------------------------------------------------
TRANSITION::20
--------------------------------------------------
TRNNo:- 20
Title:- Pressure dopped below PRES_HPCA_BLOW.
EmptyTransition:- False
Description:- Pressure dropped to PRES_HPCA_BLOW. PIC-x103 <= PRES_HPCA_BLOW
Condition:- A(;
L 	#_pi_vessel;
L 	#_pres_hpca_blow;
<=R;
);


--------------------------------------------------
STEP::15
--------------------------------------------------
StepNo:- 15
Title:- UO_MX_SIP : Automatic MX SIP ABORT
Description:- Log automatic ABORT.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log automatic ABORT.
Action:- SET;
S #_log_msg_sip_abort;
R #_Report_Evnt_019;

//Report Event Set
SET;
S #_Report_Evnt_020;

Verification:- A M1.1; //Always High flag


--------------------------------------------------
TRANSITION::19
--------------------------------------------------
TRNNo:- 19
Title:- Always High
EmptyTransition:- False
Description:- Always High
Condition:- A M1.1;


--------------------------------------------------
STEP::16
--------------------------------------------------
StepNo:- 16
Title:- UO_MX_SIP : Start HPCA pressure control
Description:- Log time when pressure reached.
Enable Mx HPCA pressure control at setpoint PRES_HPCA_BLOW.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log time when pressure reached
Start HPCA pressure control at setpoint pres_hpca_blow.

Action:- //Log time when pressure reached
SET;
S #_log_msg_pres_blow_reached;

// Enable Mx HPCA pressure control at setpoint PRES_HPCA_BLOW.
L #_pres_hpca_blow;
T #_emc_gas_setpoint;
L "dbCONST".SEL.GAS.HPCA;
T #_emc_gas_medium;
L "dbCONST".BLK.EMC1.SUBS.PRESSURE;
T #_emc_gas_subs;
L "dbCONST".BLK.CMD.START;
T #_emc_gas_cmd;
Verification:- A(;
L #_emc_gas_state;
L "dbCONST".BLK.EMC1.SUBS.PRESSURE;
==I;
);


--------------------------------------------------
TRANSITION::21
--------------------------------------------------
TRNNo:- 21
Title:- Empty transition.
EmptyTransition:- False
Description:- Empty transition.
Condition:- A M1.1; //Always High flag


--------------------------------------------------
STEP::17
--------------------------------------------------
StepNo:- 17
Title:- UO_MX_SIP : Wait for HPCA blow complete or to pulse drain
Description:- Start MX Drain valve pulse timer (time_drain_pulse)

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Start MX Drain valve pulse timer.
Action:- // Start vacuum timer
A #SQ_TIMER.Q;
R #SQ_TIMER.IN;

AN #SQ_TIMER.Q;
S #SQ_TIMER.IN;
L #_time_drain_pulse;
T #SQ_TIMER.PT;
Verification:- A M1.1; //Always High flag

A #SQ_TIMER.IN;


--------------------------------------------------
TRANSITION::22
--------------------------------------------------
TRNNo:- 22
Title:- Finished pulsing drain valves?
EmptyTransition:- False
Description:- Drain valves pulsed pulse_number times
Condition:- A(;
L 	#_pulse_counter;
L 	#_pulse_number;
>=I;
);



--------------------------------------------------
STEP::18
--------------------------------------------------
StepNo:- 18
Title:- UO_MX_SIP : Pulse SIP drain valve opened
Description:- Close valves on Sy, SMFLx and FLz path to Drain flow path, SIP condensate drain valve and vent filter drain valve.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Close valves on Sy, SMFLx and FLz path to Drain flow path, SIP condensate drain valve and vent filter drain valve.
Action:- L "dbCONST".BLK.SAFE.CMD;
T  #_emx_drain_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emx_drain_cmd;

L "dbCONST".BLK.SAFE.CMD;
T  #_emg_filter_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emg_filter_cmd;

L "dbCONST".BLK.SAFE.CMD;
T  #_emx_mmfl_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emx_mmfl_cmd;

Verification:- A(;
L #_emx_drain_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);
A(;
L #_emg_filter_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);
A(;
L #_emx_mmfl_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);

--------------------------------------------------
ACTION::02
--------------------------------------------------
Description:- Timer
Action:- //Start Timer
A #SQ_TIMER.Q;
R #SQ_TIMER.IN;

AN #SQ_TIMER.Q;
S #SQ_TIMER.IN;
L #_time_drain_pulse;
T #SQ_TIMER.PT;
Verification:- A #SQ_TIMER.IN;


--------------------------------------------------
TRANSITION::24
--------------------------------------------------
TRNNo:- 24
Title:- Timer expired?
EmptyTransition:- False
Description:- Time for drain pulsing TIME_DRAIN_PULSE expired.
Condition:- A #SQ_TIMER.Q;


--------------------------------------------------
STEP::19
--------------------------------------------------
StepNo:- 19
Title:- UO_MX_SIP : Wait for time to pulse drain valve
Description:- Increment pulse_counter.
Open valves on Sy, SMFLx and FLz path to Drain flow path, SIP condensate drain valve and vent filter drain valve.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Increment pulse_counter
Stop EM to be able to apply start same substate with different settings
Action:- //Counter
L #_pulse_counter;
INC 1;
T #_pulse_counter;
Verification:- A M1.1

--------------------------------------------------
ACTION::02
--------------------------------------------------
Description:- Open valves on Sy, SMFLx and FLz path to Drain flow path.
Start EMX6_SIP, EMX2_SIP, EMX4_SIP.
Open SIP condensate drain valve and vent filter drain valve.
Action:- //Start emx_mmfl SIP.
L "dbCONST".BLK.EMX1.SUBS.SIP;
T #_emx_mmfl_subs;
L "dbCONST".BLK.CMD.START;
T #_emx_mmfl_cmd;

//Start EMX4_SIP.
L "dbCONST".BLK.EMX4.SUBS.SIP;
T #_emx_drain_subs;
L "dbCONST".BLK.CMD.START;
T #_emx_drain_cmd;

// Set vessel VENT filter EM to substate SIP
L "dbCONST".BLK.EMG1.SUBS.SIP;
T #_emg_filter_subs;
L "dbCONST".BLK.CMD.START;
T #_emg_filter_cmd;

Verification:- A(;
L #_emv_vessel_state;
L "dbCONST".BLK.EMV1.SUBS.DISCHARGE;
==I;
);
A(;
L #_emx_smfl_state;
L "dbCONST".BLK.EMX6.SUBS.SIP;
==I;
);
A(;
L #_emx_transfer_state;
L "dbCONST".BLK.EMX2.SUBS.SIP;
==I;
);
A(;
L #_emx_drain_state;
L "dbCONST".BLK.EMX4.SUBS.SIP;
==I;
);
A(;
L #_emg_filter_state;
L "dbCONST".BLK.EMG1.SUBS.SIP;
==I;
);

--------------------------------------------------
ACTION::03
--------------------------------------------------
Description:- Timer
Action:- //Start Timer
A #SQ_TIMER.Q;
R #SQ_TIMER.IN;

AN #SQ_TIMER.Q;
S #SQ_TIMER.IN;
L #_time_drain_pulse;
T #SQ_TIMER.PT;
Verification:- A #SQ_TIMER.IN;


--------------------------------------------------
TRANSITION::25
--------------------------------------------------
TRNNo:- 25
Title:- Finished pulsing drain valves after repeats.
EmptyTransition:- False
Description:- Drain valves pulsed pulse_number times after delay OR pulse wait time expired
Condition:- A(;
O(;
L 	#_pulse_counter;
L 	#_pulse_number;
>=I;
);
O #SQ_TIMER.Q;
);


--------------------------------------------------
STEP::20
--------------------------------------------------
StepNo:- 20
Title:- UO_MX_SIP : Disable HPCA and wait for reduced pressure
Description:- Disable Mx HPCA pressure control.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Stop Mx HPCA pressure control.
Action:- //Stop Mx HPCA pressure control
L "dbCONST".BLK.SAFE.CMD;
T  #_emc_gas_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emc_gas_cmd;
Verification:- A(;
L 	#_emc_gas_state;
L 	"dbCONST".BLK.STATE.STOPPED;
==I;
);


--------------------------------------------------
TRANSITION::26
--------------------------------------------------
TRNNo:- 26
Title:- HPCA pressure below PRES_HPCA_LEAVE.
EmptyTransition:- False
Description:- Pressure below PRES_HPCA_LEAVE. PIC_x103 <= PRES_HPCA_LEAVE
Condition:- A(;
L 	#_pi_vessel;
L 	#_pres_hpca_leave;
<=R;
);


--------------------------------------------------
STEP::21
--------------------------------------------------
StepNo:- 21
Title:- UO_MX_SIP : Pressure reduced. Wait to close vessel outlet valve
Description:- Log time when pressure reached.
Close Mx vent filter drain valve and valves on Mx to Drain flow path sequentially backwards until Mx vessel outlet valve.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Log time when pressure reached.

Action:- //Log time when pressure reached.
SET;
S #_log_msg_pres_leave_reached;

L "dbCONST".BLK.SAFE.CMD;
T  #_emx_drain_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emx_drain_cmd;

L "dbCONST".BLK.SAFE.CMD;
T  #_emg_filter_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emg_filter_cmd;

L "dbCONST".BLK.SAFE.CMD;
T  #_emx_mmfl_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emx_mmfl_cmd;

L "dbCONST".BLK.SAFE.CMD;
T  #_emv_vessel_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emv_vessel_cmd;
Verification:- A(;
L #_emx_drain_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);
A(;
L #_emg_filter_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);
A(;
L #_emx_mmfl_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);
A(;
L #_emv_vessel_state;
L "dbCONST".BLK.STATE.STOPPED;
==I;
);


--------------------------------------------------
TRANSITION::27
--------------------------------------------------
TRNNo:- 27
Title:- Empty transition.
EmptyTransition:- False
Description:- Unconditional jump
Condition:- A M1.1; //Always High flag


--------------------------------------------------
STEP::22
--------------------------------------------------
StepNo:- 22
Title:- UO_MX_SIP : Start LPCA blanketing and open vent valve
Description:- Enable Mx LPCA pressure control at setpoint PRES_LPCA_BLANK.
Open vent valve.
Release Mx.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Enable Mx LPCA pressure control at setpoint PRES_LPCA_BLANK.
Open vent valve.
Action:- // Enable Mx LPCA pressure control and open Vent valve.
L #_pres_lpca_blank;
T #_emc_gas_setpoint;
L "dbCONST".SEL.GAS.LPCA;
T #_emc_gas_medium;
L "dbCONST".BLK.EMC1.SUBS.PRESSURE;
T #_emc_gas_subs;
L "dbCONST".BLK.CMD.START;
T #_emc_gas_cmd;

//Release Mx
SET;
S #_release_mx;
Verification:- //Verify LCPA pressure control enabled.
A(;
L #_emc_gas_state;
L "dbCONST".BLK.EMC1.SUBS.PRESSURE;
==I;
);


--------------------------------------------------
TRANSITION::28
--------------------------------------------------
TRNNo:- 28
Title:- Empty transition.
EmptyTransition:- False
Description:- Unconditional jump
Condition:- A M1.1; //Always High flag


--------------------------------------------------
STEP::23
--------------------------------------------------
StepNo:- 23.0000
Title:- UO_MX_SIP : Connect Pre Filter to to Flow Plate FPx1.
Description:- Prompt Operator to connect Flowplate FPx1 ZSCx113. 

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- PH_EMX1_FILTER_SETUP
Action:- //Start EMX1_SETUP_FILTER.
L "dbCONST".BLK.EMX1.SUBS.SETUP_FILTER;
T #_emx_mmfl_subs;
L "dbCONST".BLK.CMD.START;
T #_emx_mmfl_cmd;
Verification:- A(;
L #_emx_mmfl_state;
L "dbCONST".BLK.EMX1.SUBS.SETUP_FILTER;
==I;
);


--------------------------------------------------
STEP::24
--------------------------------------------------
StepNo:- 24.0000
Title:- UO_MX_SIP : Unit Operation Completed
Description:- Set equipment to SAFE state.
Log operator confirmation.
Log SIP operation end time.

--------------------------------------------------
ACTION::01
--------------------------------------------------
Description:- Set equipment to SAFE state.
Log SIP operation end time.
Action:- L "dbCONST".BLK.SAFE.CMD;
T  #_emc_water_subs;
L "dbCONST".BLK.CMD.STOP;
T  #_emc_water_cmd;

//Log SIP operation end time.
L "dbCONST".CHRONO.CPU_TIME;
T #_time_sip_end;

SET;
S #_log_time_sip_end;

Verification:- A M1.1;

****************************************************************************************************
END SSS REPORT
****************************************************************************************************
